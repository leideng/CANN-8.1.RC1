#!/usr/bin/env python
# -*- coding:utf-8 -*-
# Copyright 2023 Huawei Technologies Co., Ltd
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# ============================================================================
"""
extract_image_patches format NCHW tilingcase
"""
class EIPNCHWTilingCase:
    def __init__(self, key):
        self.key = key


def eip_nchw_tiling_case(outs, option=None):
    tiling_key = outs[0].op.attrs.get("tiling_key")
    if tiling_key > 0:
        tiling_key_list = [tiling_key]
    else:
        tiling_key_list = [
            20001,  # (ub_factor, c, kh, kw, ho, wo) per loop

            20002,  # (1, ub_factor, kh, kw, ho, wo) per loop
            20003,  # (1, c, ub_factor, kw, ho, wo) per loop

            20004,  # (1, c0, ub_factor, kw, ho, wo) per loop
            20005,  # (1, ub_factor, 1, kw, ho, wo) per loop

            20006,  # (1, ub_factor, 1, 1, 1, wo) per loop
            20007,  # (1, c, 1, 1, 1, ub_factor) per loop

            20008  # (1, c0, 1, 1, 1, ub_factor) per loop
        ]

    return [EIPNCHWTilingCase(tk) for tk in tiling_key_list]
