#!/usr/bin/env python
# -*- coding: UTF-8 -*-
# Copyright 2021-2022 Huawei Technologies Co., Ltd
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# ============================================================================
"""
constants: for transdata classify
"""
import operator
from functools import reduce
from .constants import PAD_32
from .constants import PAD_16
from .constants import PAD_8


def math_prod(iterable):
    return reduce(operator.mul, iterable, 1)


def pad_refined(factor, other):
    # buffer align has problem(Template-Code)
    if factor == -1:
        return PAD_16
    # C0
    if factor in [PAD_8, PAD_16, PAD_32]:
        return factor
    # NOT C0
    for i in [PAD_8, PAD_16, PAD_32]:
        if set_align(other, i) == factor:
            return i

    return factor


def set_align(dim, factor):
    return (dim + factor - 1) // factor * factor
