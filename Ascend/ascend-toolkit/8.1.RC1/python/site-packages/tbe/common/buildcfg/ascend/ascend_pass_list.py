#!/usr/bin/env python
# coding: utf-8
# Copyright 2021 Huawei Technologies Co., Ltd
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# ============================================================================
from tbe.tvm.tir.transform.transform import *
from tbe.tvm.tir.transform.transform_extended import *

base_static_list = [
    (0, ChangeL1FusionDataFlow()),
    (0, RemapBufferAddress()),
    (0, TextureFlatten()),
    (0, StorageFlatten(64)),
    (0, ClearTailAddr()),
    (0, TransformReverseSchedule()),
    (0, DataTypeChecker()),
    (0, CanonicalSimplify()),
    (0, RemoveInvalidLoop()),
    (1, RemoveDuplicatesInLoad()),
    (1, ReuseBuf()),
    (1, ReuseCoAxisBuffer()),
    (1, InjectDeterministicAnalysis()),
    (1, FullySplitLoopPartition()),
    (1, AlignLeafIterVars()),
    (1, LowerInitBlock()),
    (1, PlanAndUpdateBufferAllocationLocation()),
    (1, ConvertBlocksToOpaque()),
    (1, CompactBufferAllocation()),
    (1, LowerMatchBuffer()),
    (1, FlattenBuffer()),
    (1, SubstituteRunOnceDBVar()),
    (1, ConstantAllocate()),
    (1, SinglePointManager()),
    (1, UnrollLoop()),
    (1, RemoveNoOp()),
    (1, CanonicalSimplify()),
    (1, RemoveNoOp()),
    (1, FissionLoop()),
    (1, SparseAccessTransform()),
    (1, PragmaPropagation()),
    (1, BranchMotion()),
    (1, DeadCodeElimination()),
    (1, EmitInsn()),
    (1, SetAutoAtomic()),
    (1, DebugTikPreprocess()),
    (1, InjectMultiCoreSync()),
    (1, SplitCoproc()),
    (1, RemoveRedundantRegMov()),
    (1, SequenceSprInsn()),
    (2, TikDoubleBufferSupport()),
    (2, InjectPipeBuffer()),
    (2, OptimizeDMA()),
    (2, SubstituteInstr()),
    (2, InjectAccessPtrMSG()),
    (2, InjectPipe()),
    (2, DeSequenceSprInsn()),
    (2, CanonicalSimplify()),
    (2, SetSPROptimizer()),
    (2, ConstantFolding()),
    (2, LoopPartition()),
    (2, VectorizeLoop()),
    (2, InjectVirtualThread()),
    (3, InjectDoubleBuffer()),
    (3, StorageRewriteCCE()),
    (3, ReorderProcess()),
    (3, TikDynamicShapeAllocMem()),
    (3, UnrollLoop()),
    (3, AutoFuseBuffer()),
    (3, SetCacheMode()),
    (3, Simplify()),
    (3, GMConflictElimination()),
    (3, MarkScalarCoreType()),
    (4, JumpInstructionElimination()),
    (4, InjectSync()),
    (4, PackIntrinArgConfig()),
    (4, RemoveAccessPtrMSG()),
    (4, Simplify()),
    (4, GmAddrPrompt()),
    (4, ShiftBlockAccess()),
    (4, InsertCheckInvalidAccessOfDDR()),
    (4, LowerDeviceStorageAccessInfo()),
    (4, RemoveNoOp()),
    (4, RewriteUnsafeSelect()),
    (4, DeviceMark()),
    (4, InstrumentBoundCheckers()),
    (4, ConvertFloorDivToTruncDiv()),
    (4, EvaluateExternVar()),
    (4, MultiCoreReconstruct()),
    (4, BuildVirtualCore()),
    (4, SplitCoreCode()),
    (4, EnableVectorCore()),
]

base_dynamic_list = [
    (0, ExprSplit()),
    (0, ExtractExtent()),
    (0, TextureFlatten()),
    (0, StorageFlatten(64)),
    (0, ClearTailAddr()),
    (0, TransformReverseSchedule()),
    (0, DataTypeChecker()),
    (0, RemoveDuplicatesInLoad()),
    (0, ReuseBuf()),
    (0, ReuseCoAxisBuffer()),
    (0, InjectDeterministicAnalysis()),
    (0, FullySplitLoopPartition()),
    (0, SinglePointManager()),
    (0, PartitionSpecifiedRange()),
    (0, Select2If()),
    (0, LowerInitBlock()),
    (0, PlanAndUpdateBufferAllocationLocation()),
    (0, ConvertBlocksToOpaque()),
    (0, CompactBufferAllocation()),
    (0, LowerMatchBuffer()),
    (0, FlattenBuffer()),
    (0, UnrollLoop()),
    (0, Simplify({}, tvm.arith.SimplifyMode.FULL_SIMPLIFY_MODE)),
    (0, RemoveNoOp()),
    (0, EliminateBranch()),
    (0, AlignLeafIterVars()),
    (0, SubstituteRunOnceDBVar()),
    (0, FissionLoop()),
    (0, SparseAccessTransform()),
    (0, PragmaPropagation()),
    (0, DeadCodeElimination()),
    (0, InjectValidator()),
    (0, ExtractComplexExpr()),
    (0, Simplify()),
    (1, OutlineVF()),
    (1, EmitInsn()),
    (1, SetAutoAtomic()),
    (1, LoopUnswitch(False)),
    (1, OptimizeSetIntrin()),
    (1, InjectMultiCoreSync()),
    (1, EnableTempBufferDb()),
    (1, SplitCoproc()),
    (1, RemoveRedundantRegMov()),
    (1, ExtractLetStmt()),
    (1, AdjustExtent()),
    (1, TikDoubleBufferSupport()),
    (1, InjectPipeBuffer()),
    (1, MixPipelineOptimize()),
    (1, OptimizeDMA()),
    (1, SubstituteInstr()),
    (1, InjectAccessPtrMSG()),
    (1, InjectPipe()),
    (1, SetSPROptimizer()),
    (1, RemoveNoOp()),
    (1, StorageRewriteCCE()),
    (1, UnrollLoop()),
    (1, AutoFuseBuffer()),
    (2, MarkScalarCoreType()),
    (2, InjectSync()),
    (2, LoopUnswitch(True)),
    (2, RemoveAccessPtrMSG()),
    (2, InsertCheckInvalidAccessOfDDR()),
    (2, LowerDeviceStorageAccessInfo()),
    (2, RemoveNoOp()),
    (2, RewriteUnsafeSelect()),
    (2, InstrumentBoundCheckers()),
    (2, ShiftBlockAccess()),
    (2, InjectStrideInfoIntoForLoop()),
    (2, MergeSameIfCondition()),
    (2, Simplify({}, tvm.arith.SimplifyMode.FULL_SIMPLIFY_MODE)),
    (2, RemoveInvalidLoop()),
    (2, HoistKernelInvariantVar()),
    (2, ConvertFloorDivToTruncDiv()),
    (2, DeviceMark()),
    (2, EvaluateExternVar()),
    (2, MultiCoreReconstruct()),
    (2, Int64Prompt()),
    (2, BuildVirtualCore()),
    (2, SplitCoreCode()),
    (2, EnableVectorCore()),
]

regbase_v2_unified_list = [
    (0, ChangeL1FusionDataFlow()),
    (0, RemapBufferAddress()),
    (0, ExtractExtent()),
    (0, TextureFlatten()),
    (0, StorageFlatten(64)),
    (0, TransformReverseSchedule()),
    (0, ConstantFolding()),
    (0, TranslateToScalarExpr()),
    (0, DataTypeChecker()),
    (0, CanonicalSimplify()),
    (0, RemoveInvalidLoop()),
    (0, RemoveDuplicatesInLoad()),
    (0, ReuseBuf()),
    (0, ReuseCoAxisBuffer()),
    (0, InjectDeterministicAnalysis()),
    (0, FullySplitLoopPartition()),
    (0, AlignLeafIterVars()),
    (0, SinglePointManager()),
    (0, PartitionSpecifiedRange()),
    (0, Select2If()),
    (0, SubstituteRunOnceDBVar()),
    (0, ConstantAllocate()),
    (0, UnrollLoop()),
    (0, Simplify({}, tvm.arith.SimplifyMode.FULL_SIMPLIFY_MODE)),
    (0, RemoveNoOp()),
    (0, CanonicalSimplify()),
    (0, RemoveNoOp()),
    (0, FissionLoop()),
    (0, SparseAccessTransform()),
    (0, PragmaPropagation()),
    (0, BranchMotion()),
    (0, DeadCodeElimination()),
    (0, EliminateBranch()),
    (0, AlignLeafIterVars()),
    (0, InjectValidator()),
    (0, ExtractComplexExpr()),
    (0, Simplify()),
    (1, OutlineVF()),
    (1, NormalizeIR()),
    (1, ConstantFolding()),
    (1, RemoveInvalidLoop()),
    (1, Vectorize()),
    (1, CanonicalSimplify()),
    (1, RemoveInvalidLoop()),
    (1, MarkVF()),
    (1, FuseLoopInVF()),
    (1, MappingInstr()),
    (1, DebugTikPreprocess()),
    (1, CanonicalizeVF()),
    (1, FuseVF()),
    (1, OptimizeVF()),
    (1, GenerateVF()),
    (1, MergeDynamicSharedMemoryAllocations()),
    (1, ThreadSync("global")),
    (1, ThreadSync("shared")),
    (1, LowerWarpMemory()),
    (1, EmitInsn()),
    (1, SetAutoAtomic()),
    (2, LoopUnswitch(True)),
    (2, OptimizeSetIntrin()),
    (2, InjectMultiCoreSync()),
    (2, SplitCoproc()),
    (2, EnableTempBufferDb()),
    (2, ExtractLetStmt()),
    (2, AdjustExtent()),
    (2, SequenceSprInsn()),
    (2, TikDoubleBufferSupport()),
    (2, InjectPipeBuffer()),
    (2, OptimizeDMA()),
    (2, SubstituteInstr()),
    (2, InjectAccessPtrMSG()),
    (2, InjectPipe()),
    (2, SetSPROptimizer()),
    (2, DeSequenceSprInsn()),
    (2, CanonicalSimplify()),
    (2, SetSPROptimizer()),
    (2, ConstantFolding()),
    (2, InjectVirtualThread()),
    (2, StorageRewriteCCE()),
    (2, ReorderProcess()),
    (2, TikDynamicShapeAllocMem()),
    (2, UnrollLoop()),
    (2, AutoFuseBuffer()),
    (2, SetCacheMode()),
    (2, Simplify()),
    (2, GMConflictElimination()),
    (2, MarkScalarCoreType()),
    (2, InjectVFSync()),
    (2, JumpInstructionElimination()),
    (2, InjectSync()),
    (2, SubstituteMoveAlign()),
    (2, PackIntrinArgConfig()),
    (2, LoopUnswitch(True)),
    (2, RemoveAccessPtrMSG()),
    (2, Simplify()),
    (2, GmAddrPrompt()),
    (2, InsertCheckInvalidAccessOfDDR()),
    (2, LowerDeviceStorageAccessInfo()),
    (2, RemoveNoOp()),
    (2, ShiftBlockAccess()),
    (2, InjectStrideInfoIntoForLoop()),
    (2, MergeSameIfCondition()),
    (2, Simplify({}, tvm.arith.SimplifyMode.FULL_SIMPLIFY_MODE)),
    (2, RemoveInvalidLoop()),
    (2, HoistKernelInvariantVar()),
    (2, ConvertFloorDivToTruncDiv()),
    (2, EvaluateExternVar()),
    (2, MultiCoreReconstruct()),
    (2, Int64Prompt()),
    (2, DeviceMark()),
    (2, BuildVirtualCore()),
    (2, SplitCoreCode()),
]
