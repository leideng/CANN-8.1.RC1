#!/usr/bin/env python
# coding: utf-8
# Copyright 2021 Huawei Technologies Co., Ltd
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# ============================================================================

from tbe.common import platform as cce

from .ascend import base_static_list
from .buildcfg_mapping import *

"""cce default static build config"""
cce_default_static_build_config = {
    disable_fixed_pass: True,
    lic_params: "",
    apply_tbe_pass: True,
    dump_cce_code: False,
    add_lower_pass: base_static_list,
    predicate_realize_bound: True,
    constant_realize_extent_in_infer_bound: True,
    bool_storage_as_1bit: True,
    Pass_InjectSync: {sync_mode: 2, sync_opt_for_notail_db: 0, loop_ext_gt_one: True,
                      sync_opt_for_preload_loop_zero: False, multi_dims_mem_analysis: False},
    debug_message: False,
    out_of_bound_sync_check: False,
    save_temp_cce_file: False,
    dump_ir: False,
    enable_const_fold: False,
    tik_debug_context_id: -1,
    double_buffer_non_reuse: False,
    bind_reduction_using_block: True,
    enable_vector_2x: True,
    read_write_bank_conflict: False,
    dummy_placeholder: True,
    use_realize_bound_simplify: False,
    l1_fusion_option: False,
    dynamic_shape: False,
    enable_vector_hierarchical_emit: False,
    enable_mask_counter_mode: "default_normal",
    enable_branch_eliminator_else_case: True,
    build_fatbin: False,
    parse_ddr_args: False,
    let_stmt_not_inline: False,
    double_buffer_no_tail: False,
    dump_error_info: True,
    build_sub_function: False,
    limit_ir_lines: [],
    enable_precise_sync_in_emit_insn: False,
    tbe_debug_level: 0,
    out_of_order: False,
    size_of_issueQ: 32,
    precise_bound: True,
    pipeline_opt: False,
    vector_fp_ceiling: 2,
    remove_duplicates_in_load: False,
    tik: False,
    dynamic_tik: False,
    disable_float_overflow: False,
    status_check: False,
    op_L1_fusion_type: -1,  # from L1BufferManager
    enable_L1_fusion: False,  # from L1BufferManager
    enable_L2_fusion: False,  # from L1BufferManager
    l2_mode: 0,
    kernel_meta_parent_dir: ".",
    enable_op_prebuild: False,
    enable_group_inplace: False,
    incremental_link: [],
    dump_to_header_file: False,
    Pass_FullySplitLoopPartition: {partition_only_inner: 20000},
    enable_hsync: True,
    enable_hsync_not_transitive: False,
    unit_flag_mode: "auto",
    enable_db_fold: False,
    barrier_opt_in_different_branch: True,
    forbid_inplace_due_to_pipe_conflict: False,
    enable_loop_partition: False,
    enable_alloc_mem_by_use_count: False,
    enable_dma_optimizer: True,
    enable_cce_debug_mode: False,
    tbe_workspace_size_list_length: 0,
    analysis_sync_with_tensor: False,
    enable_accuracy_promote: False,
    indirect_dep_remove_across_branch: False,
    inplace_output_tensor_index: [],
    enable_multi_preload: False,
    random_cce_file_location: True,
    early_start_mode: "disable",
    op_debug_config: "",
    enable_auto_atomic: [],
    enable_burst_size_limit: [],
    evaluate: {},
    enable_deterministic_mode: False,
    enable_multicore_sync_with_atomic: False,
    predicate_total_out_of_bound: True,
    ddr_base_property: [],
    enforce_mix_mode: False,
    enable_s64_to_s32: False,
    jit_compile_mode: 0,
    rw_bank_conflict_scope_level: [cce.scope_cbuf],
    enable_model_fusion: False,
    enable_int64_vec_simulate: False,
    enable_cce_licm_safe_hoist: False,
    enable_cce_aicore_debug: False,
    cce_simt_mode: "hybrid",
    enable_machine_outliner: False,
    enable_buf_id_mode: False,
    enable_dcache: False,
    duplicate_codes: 0,
    enable_vector_core: False,
    enable_dfx: True,
    enable_vcmaxmin: True,
    enable_cce_remat_higher_weight: False,
    enable_super_kernel: False,
    workspace_tensor_size: [],
}

"""dynamic build config dict"""
dynamic_build_config_dict = {
    dynamic_shape: True,
    bool_storage_as_1bit: False,
    out_of_bound_sync_check: True,
    dummy_placeholder: True,
    enable_vector_hierarchical_emit: True,
    enable_branch_eliminator_else_case: True,
    build_fatbin: False,
    parse_ddr_args: False,
    let_stmt_not_inline: True,
    double_buffer_no_tail: True,
    enable_precise_sync_in_emit_insn: True,
    analysis_sync_with_tensor: True,
    constant_realize_extent_in_infer_bound: False,
}
