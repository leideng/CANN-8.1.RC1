#!/usr/bin/env python
# -*- coding:utf-8 -*-
"""
Copyright (C) 2022. Huawei Technologies Co., Ltd. All rights reserved.
FILE:     decorators_vsqz.py
DESC:     this file contains many decorator
CREATED:  2022-6-16 20:12:13
MODIFIED: 2022-6-16 14:04:45
"""
from functools import wraps
from tbe.tik.debug.intrinsic_v210_data_move import GetVsqzElemCount
from tbe.tik.debug.tikdbg.codemapping import get_caller_context


def get_vsqz_elem_count_decorators(func):
    """
    bind this decorator with get vsqz elem_count
    """
    @wraps(func)
    def wrapper(tik_instance, src):
        if not tik_instance.debug_disabled:
            stmt = GetVsqzElemCount(get_caller_context(), src, tik_instance.context.tik_debugger)
            tik_instance.context.curr_scope().add_stmt(stmt)
        return func(tik_instance, src)
    return wrapper
