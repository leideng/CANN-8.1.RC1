#!/usr/bin/env python
# -*- coding:utf-8 -*-
"""
Copyright (C) 2019. Huawei Technologies Co., Ltd. All rights reserved.
FILE:     common_nametuple_util.py
DESC:     util for tik_ir_builder.
CREATED:  2021-12-09 18:53:42
MODIFIED: 2021-12-09 21:29:18
"""
from collections import namedtuple

VecSingleApi = namedtuple('VecSingleApi', ["name", "mask", "dst", "src", "repeat_times", "dst_blk_stride",
                                           "src_blk_stride", "dst_rep_stride", "src_rep_stride", "stride_unit",
                                           "api_name"])

VecScalarMultisApi = namedtuple('ScalarMultisApi', ["name", "mask", "dst", "src", "scalar", "repeat_times",
                                                    "dst_blk_stride", "src_blk_stride", "dst_rep_stride",
                                                    "src_rep_stride", "stride_unit", "round_en", "mask_mode",
                                                    "api_name"])

VecDupApi = namedtuple('DupApi', ["name", "mask", "dst", "scalar", "repeat_times", "dst_blk_stride",
                                  "dst_rep_stride", "stride_unit", "mask_mode", "api_name"])

VecVcmpApi = namedtuple('VcmpApi', ["name", "mask", "src0", "src1", "src0_blk_stride", "src1_blk_stride", "api_name"])

TaylorTuple = namedtuple("TaylorTuple", ["name", "mask", "dst", "src", "work_tensor", "repeat_times",
                                         "dst_blk_stride", "src_blk_stride", "dst_rep_stride", "src_rep_stride",
                                         "src_data_size", "src_offset", "mask_o", "stride_unit"])

VecVcmpvApi = namedtuple('VcmpvApi', ["name", "mask", "dst", "src0", "src1", "repeat_times", "src0_blk_stride",
                                      "src1_blk_stride", "src0_rep_stride", "src1_rep_stride", "api_name"])

VecMultiApi = namedtuple('MultiApi', ["name", "mask", "dst", "src0", "src1", "repeat_times", "dst_blk_stride",
                                      "src0_blk_stride", "src1_blk_stride", "dst_rep_stride", "src0_rep_stride",
                                      "src1_rep_stride", "stride_unit", "api_name"])

VlnHighPreciTuple = namedtuple('VlnHighPreciTup', ["mask", "dst", "src", "work_tensor",
                                                   "repeat_times", "dst_rep_stride", "src_rep_stride"])

VlnComputePreci = namedtuple("HighPreci", ['context', 'mask', 'dst_data', 'src_data', 'tmp_work_tensor',
                                           'repeat_times', 'src_rep_stride', 'src_data_size', 'src_offset'])

VlnComputeBlockPreci = namedtuple("HighPreci", ['context', 'mask', 'dst_data', 'tmp_dst_data', 'src_data',
                                                'tmp_work_tensor', 'repeat_times', 'src_rep_stride', 'src_data_size',
                                                'src_offset'])

VecVselApi = namedtuple('VselApi', ["mask", "mode", "dst", "sel", "src0", "src1", "repeat_times", "dst_blk_stride",
                                    "src0_blk_stride", "src1_blk_stride", "dst_rep_stride", "src0_rep_stride",
                                    "src1_rep_stride", "name", "mask_o", "api_name"])

HighPreciParams = namedtuple('HighPreciParams', ["dst", "src", "work_tensor", "repeat_times",
                                                 "dst_rep_stride", "src_rep_stride"])

VconvApi = namedtuple('VconvApi', ["mask", "round_mode", "dst", "src", "repeat_times",
                                    "dst_blk_stride", "src_blk_stride", "dst_rep_stride", "src_rep_stride",
                                    "deqscale", "ldst_high_half", "stride_unit", "name", "mask_o"])

OverHighApi = namedtuple('CheckOverHighPreciApi', ["mask", "dst", "src", "work_tensor", "repeat_times",
                                                   "dst_rep_stride", "src_rep_stride", "dst_offset", "src_offset",
                                                   "work_tensor_offset", "multi_factor", "name"])

HighPreciDebug = namedtuple('HighPreciDebug', ['mask', "dst", "src", "work_tensor", "repeat_times",
                                               "dst_rep_stride", "src_rep_stride", 'api_name'])

V4dtransApi = namedtuple('V4dtrans', ['chw2hwc', 'dst', 'src', 'm_len', 'channels', 'dir_v4dtrans'])

Fp162Fp32HighPreciApi = namedtuple("Fp162Fp32HighPreci", ["source_info", "context", "func", "mask", "dst", "src",
                                                          "work_tensor", "repeat_times", "dst_rep_stride",
                                                          "src_rep_stride", "size_factor", "name"])

VecVconvApi = namedtuple("VconvApi", ["name", "mask", "round_mode", "dst", "src", "repeat_times", "dst_blk_stride",
                                      "src_blk_stride", "dst_rep_stride", "src_rep_stride", "deqscale",
                                      "ldst_high_half", "stride_unit", "mask_o", "api_name"])

Fp162Fp32ComputeDebugApi = namedtuple("Fp162Fp32ComputeDebug", ["source_info", "context", "func",
                                                                "mask", "dst", "src", "work_tensor", "repeat_times",
                                                                "dst_rep_stride", "src_rep_stride",
                                                                "fp32_rep_stride", "tmp_tensor_size", "name"])

VecSelApi = namedtuple("VecSelApi", ["mask", "mode", "dst", "sel", "src0", "src1", "repeat_times", "dst_rep_stride",
                                     "src0_rep_stride", "src1_rep_stride", "instr_name", "mask_o"])

VaddReluParams = namedtuple(
    "VaddReluParams", "mask dst src0 src1 repeat_times dst_blk_stride src0_blk_stride src1_blk_stride "
                      "dst_rep_stride src0_rep_stride src1_rep_stride")

VtransposeApi = namedtuple('VecTransApi', ['dst', 'src', 'repeat_times', 'dst_rep_stride', 'src_rep_stride'])
