#!/usr/bin/env python
# -*- coding:utf-8 -*-
"""
Copyright (C) 2019. Huawei Technologies Co., Ltd. All rights reserved.
FILE:     tik_vector_data_transform_debug.py
DESC:     this file contains many data_transform debug
CREATED:  2021-12-15 10:50:08
MODIFIED: 2021-12-15 10:50:08
"""
from functools import wraps

from tbe.tik.debug.tikdbg.codemapping import get_caller_context
from tbe.tik.debug.tik_vector_ops_debug.tik_vector_data_transform_debug_ import VnchwTrans
from tbe.tik.debug.tik_vector_ops_debug.tik_vector_data_transform_debug_ import Vnchwconv


def vec_trans_decorator(func):
    """
    bind this decorator with vec_trans

    Parameters
    ----------
    func : the decorated function

    Returns
    -------
    function
    """
    @wraps(func)
    def wrapper(op_obj):
        """
        bind this decorator with VnchwTrans
        """
        if not op_obj.tik_instance.debug_disabled:
            vtrans_stmt = VnchwTrans(get_caller_context(), op_obj)
            op_obj.tik_instance.context.curr_scope().add_stmt(vtrans_stmt)

        return func(op_obj)
    return wrapper


def vnchwconv_decorator(func):
    """
    bind this decorator with vnchwconv

    Parameters
    ----------
    func : the decorated function

    Returns
    -------
    function
    """
    @wraps(func)
    def wrapper(op_obj):
        """
        bind this decorator with vnchwconv
        """
        if not op_obj.tik_instance.debug_disabled:
            stmt = Vnchwconv(get_caller_context(), op_obj)
            op_obj.tik_instance.context.curr_scope().add_stmt(stmt)
        return func(op_obj)

    return wrapper
