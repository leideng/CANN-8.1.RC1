#!/usr/bin/env python3
# -*- coding: UTF-8 -*-
"""
Copyright (c) Huawei Technologies Co., Ltd. 2019-2020. All rights reserved.

rl schedule search, tss
"""
from schedule_search import comm
from schedule_search.controller.mcts_search.features import SEARCH_N


def proc(progress, action_mask):
    """
    规则内容：gemm只采样两种reorder顺序，mn or nm
    """
    if progress.c_op not in comm.MAD_OP_ID_LIST:
        return action_mask

    for i in range(SEARCH_N):
        if i > 1:
            action_mask[i] = 0

    return action_mask
