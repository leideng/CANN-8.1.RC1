#!/usr/bin/env python3
# -*- coding: UTF-8 -*-
"""
Copyright (c) Huawei Technologies Co., Ltd. 2019-2020. All rights reserved.

rl schedule search, tss
"""
from schedule_search import log
from schedule_search.ts_env.tensor_to_code import t2c_util


def proc(t2c_params): # pylint: disable=R0912
    """
    规则内容：不同的层分开进行reorder，但不是按编号依次reorder的
    """
    # 输入
    leveled_axis_list = []

    for stage_axis_list in t2c_params.axis_info_list:
        leveled_axis = [[], [], [], [], [], [], []]
        if stage_axis_list is not None:
            for axis_info in stage_axis_list:
                axis_name = axis_info.name
                if axis_name.endswith('_oo'):
                    leveled_axis[t2c_util.AXIS_LEVEL_OO_INDEX].append(
                        axis_info)
                elif axis_name.endswith('_o'):
                    leveled_axis[t2c_util.AXIS_LEVEL_O_INDEX].append(
                        axis_info)
                elif axis_name.endswith('_io'):
                    leveled_axis[t2c_util.AXIS_LEVEL_IO_INDEX].append(
                        axis_info)
                elif axis_name.endswith('_ii') or axis_name.endswith('_i'):
                    leveled_axis[t2c_util.AXIS_LEVEL_I_II_NORMAL_INDEX].append(
                        axis_info)
                elif axis_info.attr == "sub_axis":
                    leveled_axis[t2c_util.AXIS_LEVEL_SUB_AXIS_INDEX].append(
                        axis_info)
                elif axis_name.endswith('_iio'):
                    leveled_axis[t2c_util.AXIS_LEVEL_IIO_INDEX].append(
                        axis_info)
        leveled_axis_list.append(leveled_axis)

    log.dbg('leveled_axis_list: %s', leveled_axis_list)
    t2c_params.leveled_axis_for_reorder = leveled_axis_list
