#!/usr/bin/env python3
# -*- coding: UTF-8 -*-
"""
Copyright (c) Huawei Technologies Co., Ltd. 2019-2020. All rights reserved.

rl schedule search, tss
"""
from schedule_search import log
from schedule_search.timer import timer


@timer('cache_rw')
def proc(t2c_params, rules):  # pylint: disable=R0914
    """
    处理inline
    """
    for rule in rules:
        log.dbg("import %s", rule)
        module = __import__(rule, fromlist=['1'])
        ret = module.proc(t2c_params)
        if not ret:
            log.err('proc failed. %s', module)
            return False

    # 将生成的完整cheque信息也放在codelines中，存入py文件；
    # 后面cheque放入bank时，可以直接从py文件拿到cheque
    t2c_params.code_lines.append('')
    t2c_params.code_lines.append('# cheque_list: %s' % t2c_params.cheque_list)
    log.dbg("final cheque_list: %s", t2c_params.cheque_list)
    log.dbg("rules: %s", rules)
    return True
