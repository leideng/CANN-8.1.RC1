#!/usr/bin/env python3
# -*- coding: UTF-8 -*-
"""
Copyright (c) Huawei Technologies Co., Ltd. 2019-2020. All rights reserved.

rl schedule search, tss
"""
PATTERN_NONE = "pattern_none"

PATTERN_DICT = {
    "layernorm_fp16_1980": [
        'elewise_single_cast|not_auto_cast', 'elewise_binary_add',
        'elewise_binary_mul', 'broadcast_for_tensor',
        'elewise_single_cast|not_auto_cast', 'elewise_binary_mul',
        'elewise_binary_sub', 'elewise_single_cast|not_auto_cast',
        'broadcast_for_tensor', 'reduce_sum', 'elewise_single_VS_mul',
        'elewise_single_exp', 'elewise_single_VS_mul', 'elewise_single_log',
        'elewise_single_VS_add', 'broadcast_for_tensor', 'reduce_sum',
        'elewise_single_VS_mul', 'elewise_binary_mul', 'elewise_binary_sub',
        'broadcast_for_tensor', 'elewise_single_cast|not_auto_cast',
        'elewise_single_cast|not_auto_cast',
        'elewise_single_cast|not_auto_cast'
    ],
    "layernorm_fp32_1980": [
        'elewise_binary_add', 'elewise_binary_mul', 'broadcast_for_tensor',
        'elewise_binary_mul', 'elewise_binary_sub', 'broadcast_for_tensor',
        'reduce_sum', 'elewise_single_VS_mul', 'elewise_single_exp',
        'elewise_single_VS_mul', 'elewise_single_log', 'elewise_single_VS_add',
        'broadcast_for_tensor', 'reduce_sum', 'elewise_single_VS_mul',
        'elewise_binary_mul', 'elewise_binary_sub', 'broadcast_for_tensor',
        'elewise_set_gm_scope', 'elewise_set_gm_scope'
    ],
    "layernorm_V2_fp16_1980": [
        "elewise_single_cast|not_auto_cast", "elewise_binary_add",
        "elewise_binary_mul", "broadcast_for_tensor",
        "elewise_single_cast|not_auto_cast", "elewise_binary_div",
        "elewise_binary_sub", "elewise_single_cast|not_auto_cast",
        "broadcast_for_tensor", "reduce_sum", "elewise_single_VS_mul",
        "broadcast_for_tensor", "elewise_single_sqrt", "elewise_single_VS_add",
        "reduce_sum", "elewise_single_VS_mul", "elewise_binary_mul",
        "broadcast_for_tensor", "elewise_single_cast|not_auto_cast",
        "elewise_single_cast|not_auto_cast",
        "elewise_single_cast|not_auto_cast"
    ],
    "layernorm_V2_fp32_1980": [
        "elewise_binary_add", "elewise_binary_mul", "broadcast_for_tensor",
        "elewise_binary_div", "elewise_binary_sub", "broadcast_for_tensor",
        "reduce_sum", "elewise_single_VS_mul", "broadcast_for_tensor",
        "elewise_single_sqrt", "elewise_single_VS_add", "reduce_sum",
        "elewise_single_VS_mul", "elewise_binary_mul", "broadcast_for_tensor",
        "elewise_set_gm_scope", "elewise_set_gm_scope"
    ],
    "layernorm_x_backprop_fp16_1980": [
        "elewise_single_cast|not_auto_cast", "elewise_binary_add",
        "elewise_binary_add", "elewise_binary_mul", "broadcast_for_tensor",
        "elewise_single_exp", "elewise_single_VS_mul", "elewise_single_log",
        "elewise_single_VS_add", "elewise_single_cast|not_auto_cast",
        "elewise_binary_mul", "broadcast_for_tensor",
        "elewise_single_cast|not_auto_cast",
        "elewise_single_cast|not_auto_cast", "elewise_single_VS_mul",
        "elewise_binary_mul", "broadcast_for_tensor", "elewise_single_VS_mul",
        "elewise_binary_mul", "reduce_sum", "elewise_binary_mul",
        "elewise_binary_sub", "elewise_single_cast|not_auto_cast",
        "broadcast_for_tensor", "elewise_single_cast|not_auto_cast",
        "elewise_binary_mul", "elewise_binary_mul", "broadcast_for_tensor",
        "elewise_single_VS_mul", "elewise_binary_add", "elewise_binary_mul",
        "elewise_single_VS_mul", "reduce_sum", "elewise_single_VS_mul",
        "elewise_single_VS_mul", "elewise_binary_mul", "reduce_sum"
    ],
    "layernorm_x_backprop_fp32_1980": [
        "elewise_binary_add", "elewise_binary_add", "elewise_binary_mul",
        "broadcast_for_tensor", "elewise_single_exp", "elewise_single_VS_mul",
        "elewise_single_log", "elewise_single_VS_add", "elewise_binary_mul",
        "broadcast_for_tensor", "elewise_single_VS_mul", "elewise_binary_mul",
        "broadcast_for_tensor", "elewise_single_VS_mul", "elewise_binary_mul",
        "reduce_sum", "elewise_binary_mul", "elewise_binary_sub",
        "broadcast_for_tensor", "elewise_binary_mul", "elewise_binary_mul",
        "broadcast_for_tensor", "elewise_single_VS_mul", "elewise_binary_add",
        "elewise_binary_mul", "elewise_single_VS_mul", "reduce_sum",
        "elewise_single_VS_mul", "elewise_single_VS_mul", "elewise_binary_mul",
        "reduce_sum"
    ],
    "layer_norm_beta_gamma_backprop_fp16_1980": [
        "elewise_single_cast|not_auto_cast", "elewise_binary_sub",
        "elewise_binary_add", "reduce_sum", "elewise_binary_mul",
        "elewise_single_cast|not_auto_cast", "elewise_binary_mul",
        "broadcast_for_tensor", "elewise_single_exp", "elewise_single_VS_mul",
        "elewise_single_log", "elewise_single_VS_add",
        "elewise_single_cast|not_auto_cast", "elewise_binary_sub",
        "elewise_single_cast|not_auto_cast", "broadcast_for_tensor",
        "elewise_single_cast|not_auto_cast",
        "elewise_single_cast|not_auto_cast",
        "elewise_single_cast|not_auto_cast", "reduce_sum"
    ],
    "layer_norm_beta_gamma_backprop_fp32_1980": [
        "elewise_binary_sub", "elewise_binary_add", "reduce_sum",
        "elewise_binary_mul", "elewise_binary_mul", "broadcast_for_tensor",
        "elewise_single_exp", "elewise_single_VS_mul", "elewise_single_log",
        "elewise_single_VS_add", "elewise_binary_sub", "broadcast_for_tensor",
        "reduce_sum"
    ]
}

BUFFER_REUSE_PATTERN = [
    "layernorm_fp16_1980", "layernorm_fp32_1980", "layernorm_V2_fp16_1980",
    "layernorm_V2_fp32_1980", "layernorm_x_backprop_fp16_1980",
    "layernorm_x_backprop_fp32_1980",
    "layer_norm_beta_gamma_backprop_fp16_1980",
    "layer_norm_beta_gamma_backprop_fp32_1980"
]
