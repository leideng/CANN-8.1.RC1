#!/usr/bin/env python3
# -*- coding: UTF-8 -*-
"""
Copyright (c) Huawei Technologies Co., Ltd. 2019-2020. All rights reserved.

rl schedule search, tss
"""
from schedule_search.ts_env.tensor_cfg import ActionTensorCfg
from schedule_search.timer import timer


@timer('r15')
def proc(t2c_params):
    """
    规则内容：
    concat算子只能切concat_axis以及该轴之后的轴
    """
    # 不是concat算子不处理
    if not t2c_params.op_schedule_info.concat_dict:
        return True

    concat_axis = t2c_params.op_schedule_info.concat_dict['concat_axis']

    for axis_index in range(concat_axis):
        t2c_params.cleaned_actions[-1][ActionTensorCfg.split_factor_s +
                                       axis_index] = 1
    return True
