#!/usr/bin/env python3
# -*- coding: UTF-8 -*-
"""
Copyright (c) Huawei Technologies Co., Ltd. 2019-2020. All rights reserved.

rl schedule search, tss
"""
from schedule_search.ts_env.tensor_to_code.proc_inline.rules.comm import \
    is_special_stage


def proc(t2c_params, stage_index):
    """
    broadcast_to_tensor的需要inline掉
    """
    stage = t2c_params.schedule.stages[stage_index]
    if stage.op.tag in ['broadcast_for_tensor', 'broadcast',
                        'broadcast_for_tensor_opt'] \
            and '.local.' not in stage.op.name:
        return True

    return False
