#!/usr/bin/env python3
# -*- coding: UTF-8 -*-
"""
Copyright (c) Huawei Technologies Co., Ltd. 2019-2020. All rights reserved.

rl schedule search, tss
"""


def get_reuse_index(t2c_params, reuse_stage_index):
    '''
    获取reuse_index
    '''
    stages_info = t2c_params.op_schedule_info.stages_info
    stage_name = stages_info[reuse_stage_index]["name"]
    if stage_name in t2c_params.reuse_stages:
        reuse_index = t2c_params.reuse_stages.index(stage_name) + 1
    else:
        reuse_index = len(t2c_params.reuse_stages)
        t2c_params.reuse_stages.append(stage_name)
    return reuse_index
