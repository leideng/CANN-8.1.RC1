#!/usr/bin/env python3
# -*- coding: UTF-8 -*-
"""
Copyright (c) Huawei Technologies Co., Ltd. 2019-2020. All rights reserved.

rl schedule search, tss
"""
from schedule_search.ts_env.tensor_to_code import t2c_util


def proc(t2c_params):  # pylint: disable=R0912
    """
    规则内容：处理规格轴
    """
    # 输入
    sch = t2c_params.schedule
    c_op = t2c_params.op_schedule_info.c_op

    if c_op == 'no':
        return

    for stage_index in range(len(sch.stages)):
        stage_axis_list = t2c_params.axis_info_list[stage_index]
        if stage_axis_list is None:
            continue
        for axis_info in stage_axis_list:
            if axis_info.attr == "c":
                t2c_params.leveled_axis_for_reorder[stage_index][
                    t2c_util.AXIS_LEVEL_C_INDEX].append(axis_info)
