#!/usr/bin/env python3
# -*- coding: UTF-8 -*-
# Copyright (c) Huawei Technologies Co., Ltd. 2022-2022. All rights reserved.
"""
common apply action
"""
from auto_search.solution_space.action import apply_action_register
from auto_search.solution_space.action import SearchActionType
from auto_search.compute_analysis import ComputePattern


@apply_action_register([ComputePattern.TUPLE_REDUCE, ComputePattern.REDUCE, ComputePattern.NORM],
                       SearchActionType.UB_TRANSPOSE)
def apply(next_progress, action_value):
    """
    :param next_progress:
    :param action_value:
    :return:
    """
    if next_progress.op_schedule_info.is_align_pad:
        next_progress.op_schedule_info.is_ub_transpose = False
        return
    if action_value:
        next_progress.op_schedule_info.is_ub_transpose = True
        return
    next_progress.op_schedule_info.is_ub_transpose = False
    return
