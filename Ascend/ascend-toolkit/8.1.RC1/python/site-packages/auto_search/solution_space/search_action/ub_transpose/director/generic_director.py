#!/usr/bin/env python3
# -*- coding: UTF-8 -*-
# Copyright (c) Huawei Technologies Co., Ltd. 2022-2022. All rights reserved.
"""
common director
"""
from auto_search.solution_space.action import director_register
from auto_search.solution_space.action import SearchActionType
from auto_search.compute_analysis import ComputePattern
from auto_search.solution_space.schedule_action.emit_insn.emit_insn_action import EmitInsnAction
from auto_search.solution_space.schedule_action.split.split_action import SchSplitAction


@director_register([ComputePattern.TUPLE_REDUCE, ComputePattern.REDUCE], SearchActionType.UB_TRANSPOSE)
def direct(progress):
    """
    :param progress:
    :return:
    """
    pattern = progress.op_schedule_info.op_pattern
    next_action = EmitInsnAction(pattern)
    progress.todo = next_action


@director_register(ComputePattern.NORM, SearchActionType.UB_TRANSPOSE)
def direct_for_norm(progress):
    """
    :param progress:
    :return:
    """
    pattern = progress.op_schedule_info.op_pattern
    next_action = SchSplitAction(pattern)
    progress.todo = next_action
