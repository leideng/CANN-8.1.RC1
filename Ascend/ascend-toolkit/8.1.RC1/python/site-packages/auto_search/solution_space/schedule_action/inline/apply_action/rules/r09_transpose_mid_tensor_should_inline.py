#!/usr/bin/env python3
# -*- coding: UTF-8 -*-
# Copyright (c) Huawei Technologies Co., Ltd. 2022-2022. All rights reserved.
"""
inline rule
"""
from auto_search.solution_space.progress import Progress


def proc(progress: Progress, stage_index: int) -> bool:
    """
    transpose mid tensor inline
    :param progress:
    :param stage_index:
    :return:
    """
    stage_info = progress.op_schedule_info.stages_info[stage_index]
    # The data_x.local.UB tensor of the transpose op needs to be inline.
    if "CacheRead" in stage_info.get("type", []):
        return True

    return False
