#!/usr/bin/env python
# -*- coding:utf-8 -*-
"""
Copyright (C) 2021. Huawei Technologies Co., Ltd. All rights reserved.

Define the opat timer class
"""
import importlib
from optune_utils import log


class OpatTimer():
    """
    OpatTimer class
    """
    def __init__(self, description: object = None) -> None:
        """
        class init
        """
        self.get_raw_time_ = getattr(importlib.import_module("OpatUtils"), "get_raw_time")
        self.get_thread_id_ = getattr(importlib.import_module("OpatUtils"), "get_thread_id")
        self.start_time_ = 0
        self.stop_time_ = 0
        self.description_ = description

    def start(self) -> None:
        """
        start timer
        """
        self.start_time_ = self.get_raw_time_()
        if self.description_:
            log.event("[Tid:%s] Event [%s] begin, timestamp : %s" %
                      (str(self.get_thread_id_()), str(self.description_), str(self.start_time_)))

    def stop(self) -> None:
        """
        stop timer
        """
        self.stop_time_ = self.get_raw_time_()
        if self.description_:
            duration_time = int(self.stop_time_) - int(self.start_time_)
            log.event("[Tid:%s] Event [%s] end, timestamp : %s, during : %sns" %
                      (str(self.get_thread_id_()), str(self.description_), str(self.stop_time_), str(duration_time)))
